[2025-06-28 08:29:55,324.324] Namespace(experiment_name='IFT_Exp_NonMaskedInst_v2', base_modelName='gpt2_355M', data_path='instruction-data-NT.json', training_type='IFT', peft_type=None, load_weights=True, pre_save_model=None, model_name='gpt2_355M_nonMaskedInstruct_FineTuned_v2', tokenizer='tiktoken', seed=123, batch_size=8, train_split=0.85, val_split=0.05, context_length=1024, max_new_tokens=256, temp=0.0, dropout_rate=0.0, top_k=None, trainable_layers=None, num_epochs=4, eos_id=50256, max_training_length='longest_training_example', prompt_style='alpaca', ignore_index=-100, mask_instruction=False)
[2025-06-28 08:30:00,301.301] Configuration of the gpt2_355M base model loaded..!
[2025-06-28 08:30:00,308.308] Extention detected for the training file is "json".
[2025-06-28 08:30:00,308.308] Reading for .json files..!
[2025-06-28 08:30:00,311.311] Number of entries : 1100. 
[2025-06-28 08:30:00,311.311] Example of data for Instruct Fine-Tune :: 
 {'instruction': 'Name three forms of water.', 'input': '', 'output': 'The three forms of water are solid (ice), liquid (water), and gas (steam).'}
[2025-06-28 08:30:00,314.314] Training, Validation and Test Data created from the training file. Train data: 935, Val Data: 55, Test Data: 110
[2025-06-28 08:30:00,314.314] Loading the dataset class for instruction fine-tuning task...
[2025-06-28 08:30:01,725.725] ************** TRAIN DATALOADER ****************************
[2025-06-28 08:30:01,725.725] Length of Train Dataloader (number of batches): 116
[2025-06-28 08:30:02,221.221] torch.Size([8, 62]), torch.Size([8, 62])
[2025-06-28 08:30:02,223.223] torch.Size([8, 77]), torch.Size([8, 77])
[2025-06-28 08:30:02,224.224] torch.Size([8, 74]), torch.Size([8, 74])
[2025-06-28 08:30:02,226.226] torch.Size([8, 69]), torch.Size([8, 69])
[2025-06-28 08:30:02,228.228] torch.Size([8, 66]), torch.Size([8, 66])
[2025-06-28 08:30:02,228.228] ************** VAL DATALOADER ****************************
[2025-06-28 08:30:02,228.228] Length of Val Dataloader (number of batches): 6
[2025-06-28 08:30:02,229.229] torch.Size([8, 63]), torch.Size([8, 63])
[2025-06-28 08:30:02,231.231] torch.Size([8, 84]), torch.Size([8, 84])
[2025-06-28 08:30:02,233.233] torch.Size([8, 59]), torch.Size([8, 59])
[2025-06-28 08:30:02,236.236] torch.Size([8, 70]), torch.Size([8, 70])
[2025-06-28 08:30:02,237.237] torch.Size([8, 67]), torch.Size([8, 67])
[2025-06-28 08:30:02,237.237] ************** TEST DATALOADER ****************************
[2025-06-28 08:30:02,237.237] Length of Test Dataloader (number of batches): 13
[2025-06-28 08:30:02,241.241] torch.Size([8, 77]), torch.Size([8, 77])
[2025-06-28 08:30:02,243.243] torch.Size([8, 69]), torch.Size([8, 69])
[2025-06-28 08:30:02,244.244] torch.Size([8, 69]), torch.Size([8, 69])
[2025-06-28 08:30:02,245.245] torch.Size([8, 65]), torch.Size([8, 65])
[2025-06-28 08:30:02,247.247] torch.Size([8, 73]), torch.Size([8, 73])
[2025-06-28 08:30:02,247.247] Dataloaders created successfully for fine-tuning task..!
[2025-06-28 08:30:02,247.247] ---------------------------------------------------------
[2025-06-28 08:30:02,247.247] Loading the weights of the base model : gpt2_355M..!
[2025-06-28 08:30:02,248.248] Model present in the path: model/gpt2
[2025-06-28 08:30:12,745.745] Model weights loaded successfully..!
[2025-06-28 08:33:00,759.759] Generating a text :: 
Once upon a time, there was a man who lived in a village called Krakow. He was a very good man, and he was very kind to his children. One day, he was walking along the road, and he saw a woman walking by. He asked her if she was his daughter. She said yes, and she said that she was his daughter. He asked her if she was his wife. She said yes, and she said that she was his wife. He asked her if she was his son. She said yes, and she said that she was his son. He asked her if she was his daughter. She said yes, and she said that she was his daughter. He asked her if she was his wife. She said yes, and she said that she was his wife. He asked her if she was his son. She said yes, and she said that she was his son. He asked her if she was his daughter. She said yes, and she said that she was his daughter. He asked her if she was his wife. She said yes, and she said that she was his wife. He asked her if she was his son. She said yes, and she said that she was his son. He asked her if she was his daughter. She
[2025-06-28 08:33:00,759.759] Instruction Fine-tuning the base model: gpt2_355M ..!
[2025-06-28 08:33:00,759.759] Training the full model as no paramater efficient mechanisms are given..!
[2025-06-28 08:33:02,108.108] Training Stage : Model sent to cuda for fine-tuning..!
[2025-06-28 08:33:02,262.262] Training Stage : Fine-tuning of the model started ..!
[2025-06-28 09:49:00,310.310] Training completed in 75.97 minutes.
[2025-06-28 09:49:06,707.707] Instruction Fine-Tuned (IFT) model saved in model/gpt2_355M_nonMaskedInstruct_FineTuned_v2.pth..!
[2025-06-28 09:49:06,707.707] Saving the plots of the metrics tracked ..!
[2025-06-28 09:49:54,751.751] Saving the model response for the test dataset ..!
[2025-06-28 09:49:54,799.799] Error in model evaluation stage : 'float' object cannot be interpreted as an integer
al Tokens seen till now: 12056
Epoch No: 1, Step: 000025, Train Loss: 0.737, Test Loss: 0.833
Total Tokens seen till now: 14736
Epoch No: 1, Step: 000030, Train Loss: 0.693, Test Loss: 0.780
Total Tokens seen till now: 17432
Epoch No: 1, Step: 000035, Train Loss: 0.741, Test Loss: 0.746
Total Tokens seen till now: 20304
Epoch No: 1, Step: 000040, Train Loss: 0.654, Test Loss: 0.796
Total Tokens seen till now: 23032
Epoch No: 1, Step: 000045, Train Loss: 0.758, Test Loss: 0.714
Total Tokens seen till now: 26272
Epoch No: 1, Step: 000050, Train Loss: 0.699, Test Loss: 0.732
Total Tokens seen till now: 29104
Epoch No: 1, Step: 000055, Train Loss: 0.597, Test Loss: 0.703
Total Tokens seen till now: 31944
Epoch No: 1, Step: 000060, Train Loss: 0.652, Test Loss: 0.705
Total Tokens seen till now: 34688
Epoch No: 1, Step: 000065, Train Loss: 0.654, Test Loss: 0.740
Total Tokens seen till now: 37336
Epoch No: 1, Step: 000070, Train Loss: 0.534, Test Loss: 0.709
Total Tokens seen till now: 40232
Epoch No: 1, Step: 000075, Train Loss: 0.551, Test Loss: 0.738
Total Tokens seen till now: 42928
Epoch No: 1, Step: 000080, Train Loss: 0.661, Test Loss: 0.750
Total Tokens seen till now: 45568
Epoch No: 1, Step: 000085, Train Loss: 0.566, Test Loss: 0.632
Total Tokens seen till now: 48256
Epoch No: 1, Step: 000090, Train Loss: 0.532, Test Loss: 0.642
Total Tokens seen till now: 51112
Epoch No: 1, Step: 000095, Train Loss: 0.616, Test Loss: 0.724
Total Tokens seen till now: 54168
Epoch No: 1, Step: 000100, Train Loss: 0.537, Test Loss: 0.614
Total Tokens seen till now: 57152
Epoch No: 1, Step: 000105, Train Loss: 0.419, Test Loss: 0.645
Total Tokens seen till now: 60072
Epoch No: 1, Step: 000110, Train Loss: 0.517, Test Loss: 0.680
Total Tokens seen till now: 62904
Epoch No: 1, Step: 000115, Train Loss: 0.442, Test Loss: 0.638
Total Tokens seen till now: 65760
Below is an instruction that describes a task. Write a response that appropriately completes the request.### Instruction: Rewrite the sentence using a simile.### Input: The car is very fast.### Response:The car is as fast as a bullet.Epoch No: 2, Step: 000120, Train Loss: 0.496, Test Loss: 0.632
Total Tokens seen till now: 68408
Epoch No: 2, Step: 000125, Train Loss: 0.456, Test Loss: 0.641
Total Tokens seen till now: 71024
Epoch No: 2, Step: 000130, Train Loss: 0.439, Test Loss: 0.686
Total Tokens seen till now: 73760
Epoch No: 2, Step: 000135, Train Loss: 0.457, Test Loss: 0.709
Total Tokens seen till now: 76440
Epoch No: 2, Step: 000140, Train Loss: 0.448, Test Loss: 0.710
Total Tokens seen till now: 79208
Epoch No: 2, Step: 000145, Train Loss: 0.453, Test Loss: 0.678
Total Tokens seen till now: 81944
Epoch No: 2, Step: 000150, Train Loss: 0.374, Test Loss: 0.656
Total Tokens seen till now: 84728
Epoch No: 2, Step: 000155, Train Loss: 0.430, Test Loss: 0.661
Total Tokens seen till now: 87840
Epoch No: 2, Step: 000160, Train Loss: 0.433, Test Loss: 0.692
Total Tokens seen till now: 90896
Epoch No: 2, Step: 000165, Train Loss: 0.346, Test Loss: 0.687
Total Tokens seen till now: 93912
Epoch No: 2, Step: 000170, Train Loss: 0.397, Test Loss: 0.696
Total Tokens seen till now: 97024
Epoch No: 2, Step: 000175, Train Loss: 0.395, Test Loss: 0.715
Total Tokens seen till now: 99944
Epoch No: 2, Step: 000180, Train Loss: 0.379, Test Loss: 0.718
Total Tokens seen till now: 102704
Epoch No: 2, Step: 000185, Train Loss: 0.375, Test Loss: 0.706
Total Tokens seen till now: 105512
Epoch No: 2, Step: 000190, Train Loss: 0.378, Test Loss: 0.689
Total Tokens seen till now: 108192
Epoch No: 2, Step: 000195, Train Loss: 0.399, Test Loss: 0.668
Total Tokens seen till now: 110816
Epoch No: 2, Step: 000200, Train Loss: 0.348, Test Loss: 0.653
Total Tokens seen till now: 113696
Epoch No: 2, Step: 000205, Train Loss: 0.366, Test Loss: 0.646
Total Tokens seen till now: 116216
Epoch No: 2, Step: 000210, Train Loss: 0.349, Test Loss: 0.682
Total Tokens seen till now: 119048
Epoch No: 2, Step: 000215, Train Loss: 0.303, Test Loss: 0.664
Total Tokens seen till now: 122104
Epoch No: 2, Step: 000220, Train Loss: 0.310, Test Loss: 0.635
Total Tokens seen till now: 125016
Epoch No: 2, Step: 000225, Train Loss: 0.301, Test Loss: 0.692
Total Tokens seen till now: 127976
Epoch No: 2, Step: 000230, Train Loss: 0.350, Test Loss: 0.676
Total Tokens seen till now: 130760
Below is an instruction that describes a task. Write a response that appropriately completes the request.### Instruction: Rewrite the sentence using a simile.### Input: The car is very fast.### Response:The car is as fast as a bullet.Epoch No: 3, Step: 000235, Train Loss: 0.307, Test Loss: 0.693
Total Tokens seen till now: 133448
Epoch No: 3, Step: 000240, Train Loss: 0.286, Test Loss: 0.729
Total Tokens seen till now: 136128
Epoch No: 3, Step: 000245, Train Loss: 0.287, Test Loss: 0.687
Total Tokens seen till now: 139112
Epoch No: 3, Step: 000250, Train Loss: 0.308, Test Loss: 0.675
Total Tokens seen till now: 142168
Epoch No: 3, Step: 000255, Train Loss: 0.278, Test Loss: 0.738
Total Tokens seen till now: 145288
Epoch No: 3, Step: 000260, Train Loss: 0.281, Test Loss: 0.684
Total Tokens seen till now: 147960
Epoch No: 3, Step: 000265, Train Loss: 0.308, Test Loss: 0.700
Total Tokens seen till now: 150816
Epoch No: 3, Step: 000270, Train Loss: 0.273, Test Loss: 0.645
Total Tokens seen till now: 153856
Epoch No: 3, Step: 000275, Train Loss: 0.268, Test Loss: 0.743
Total Tokens seen till now: 156640
Epoch No: 3, Step: 000280, Train Loss: 0.298, Test Loss: 0.686
Total Tokens seen till now: 159384
Epoch No: 3, Step: 000285, Train Loss: 0.252, Test Loss: 0.694
Total Tokens seen till now: 162048
Epoch No: 3, Step: 000290, Train Loss: 0.258, Test Loss: 0.741
Total Tokens seen till now: 164872
Epoch No: 3, Step: 000295, Train Loss: 0.235, Test Loss: 0.734
Total Tokens seen till now: 167528
Epoch No: 3, Step: 000300, Train Loss: 0.250, Test Loss: 0.731
Total Tokens seen till now: 170240
Epoch No: 3, Step: 000305, Train Loss: 0.279, Test Loss: 0.790
Total Tokens seen till now: 173184
Epoch No: 3, Step: 000310, Train Loss: 0.272, Test Loss: 0.701
Total Tokens seen till now: 175680
Epoch No: 3, Step: 000315, Train Loss: 0.247, Test Loss: 0.678
Total Tokens seen till now: 178544
Epoch No: 3, Step: 000320, Train Loss: 0.251, Test Loss: 0.733
Total Tokens seen till now: 181216
Epoch No: 3, Step: 000325, Train Loss: 0.268, Test Loss: 0.650
Total Tokens seen till now: 184080
Epoch No: 3, Step: 000330, Train Loss: 0.246, Test Loss: 0.675
Total Tokens seen till now: 186816
Epoch No: 3, Step: 000335, Train Loss: 0.223, Test Loss: 0.648
Total Tokens seen till now: 189584
Epoch No: 3, Step: 000340, Train Loss: 0.249, Test Loss: 0.700
Total Tokens seen till now: 192360
Epoch No: 3, Step: 000345, Train Loss: 0.214, Test Loss: 0.633
Total Tokens seen till now: 195152
Below is an instruction that describes a task. Write a response that appropriately completes the request.### Instruction: Rewrite the sentence using a simile.### Input: The car is very fast.### Response:The car is as fast as a cheetah.Epoch No: 4, Step: 000350, Train Loss: 0.220, Test Loss: 0.728
Total Tokens seen till now: 197992
Epoch No: 4, Step: 000355, Train Loss: 0.222, Test Loss: 0.743
Total Tokens seen till now: 200744
Epoch No: 4, Step: 000360, Train Loss: 0.198, Test Loss: 0.773
Total Tokens seen till now: 203512
Epoch No: 4, Step: 000365, Train Loss: 0.241, Test Loss: 0.777
Total Tokens seen till now: 206168
Epoch No: 4, Step: 000370, Train Loss: 0.233, Test Loss: 0.750
Total Tokens seen till now: 209088
Epoch No: 4, Step: 000375, Train Loss: 0.204, Test Loss: 0.747
Total Tokens seen till now: 211808
Epoch No: 4, Step: 000380, Train Loss: 0.226, Test Loss: 0.747
Total Tokens seen till now: 214552
Epoch No: 4, Step: 000385, Train Loss: 0.202, Test Loss: 0.816
Total Tokens seen till now: 217464
Epoch No: 4, Step: 000390, Train Loss: 0.224, Test Loss: 0.787
Total Tokens seen till now: 220328
Epoch No: 4, Step: 000395, Train Loss: 0.209, Test Loss: 0.721
Total Tokens seen till now: 223264
Epoch No: 4, Step: 000400, Train Loss: 0.229, Test Loss: 0.724
Total Tokens seen till now: 226120
Epoch No: 4, Step: 000405, Train Loss: 0.219, Test Loss: 0.740
Total Tokens seen till now: 229160
Epoch No: 4, Step: 000410, Train Loss: 0.221, Test Loss: 0.738
Total Tokens seen till now: 231856
Epoch No: 4, Step: 000415, Train Loss: 0.209, Test Loss: 0.702
Total Tokens seen till now: 234512
Epoch No: 4, Step: 000420, Train Loss: 0.224, Test Loss: 0.711
Total Tokens seen till now: 237320
Epoch No: 4, Step: 000425, Train Loss: 0.192, Test Loss: 0.733
Total Tokens seen till now: 240152
Epoch No: 4, Step: 000430, Train Loss: 0.205, Test Loss: 0.721
Total Tokens seen till now: 242800
Epoch No: 4, Step: 000435, Train Loss: 0.191, Test Loss: 0.760
Total Tokens seen till now: 245584
Epoch No: 4, Step: 000440, Train Loss: 0.194, Test Loss: 0.691
Total Tokens seen till now: 248240
Epoch No: 4, Step: 000445, Train Loss: 0.194, Test Loss: 0.789
Total Tokens seen till now: 251136
Epoch No: 4, Step: 000450, Train Loss: 0.195, Test Loss: 0.697
Total Tokens seen till now: 253752
Epoch No: 4, Step: 000455, Train Loss: 0.209, Test Loss: 0.758
Total Tokens seen till now: 256784
Epoch No: 4, Step: 000460, Train Loss: 0.204, Test Loss: 0.649
Total Tokens seen till now: 259552
Below is an instruction that describes a task. Write a response that appropriately completes the request.### Instruction: Rewrite the sentence using a simile.### Input: The car is very fast.### Response:The car is as fast as a cheetah.